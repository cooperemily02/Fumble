{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _framesync = require('framesync');\n\nvar _calc = require('../inc/calc');\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar Action = function () {\n  // lawsuit - sorry\n  function Action() {\n    var _this = this;\n\n    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Action);\n\n    this.scheduledUpdate = function () {\n      _this.lastUpdated = (0, _framesync.timeSinceLastFrame)();\n      _this.prev = _this.current;\n      var _props = _this.props,\n          onUpdate = _props.onUpdate,\n          passive = _props.passive;\n\n      if (_this.update) {\n        _this.current = _this.update(_this.current);\n      }\n\n      if (onUpdate) {\n        if (onUpdate.registerAction) {\n          onUpdate.set(_this.get());\n        } else {\n          onUpdate(_this.get(), _this);\n        }\n      }\n\n      _this.fireListeners();\n\n      if (!passive && _this._isActive) {\n        (0, _framesync.onFrameUpdate)(_this.scheduledUpdate);\n      }\n\n      if (_this.isActionComplete && _this.isActionComplete()) {\n        _this.complete();\n      }\n\n      return _this;\n    };\n\n    this.props = _extends({}, this.constructor.defaultProps);\n    this.setProps(props);\n    this.lastUpdated = 0;\n    this.prev = this.current = props.current || props.from || 0;\n  }\n\n  Action.prototype.start = function start() {\n    var _props2 = this.props,\n        onStart = _props2.onStart,\n        _onStart = _props2._onStart,\n        passive = _props2.passive;\n\n    if (!passive) {\n      this._isActive = true;\n      (0, _framesync.onFrameUpdate)(this.scheduledUpdate);\n    }\n\n    if (this.onStart) this.onStart();\n    if (onStart) onStart(this);\n    if (_onStart) _onStart(this);\n    return this;\n  };\n\n  Action.prototype.stop = function stop() {\n    var _props3 = this.props,\n        onStop = _props3.onStop,\n        _onStop = _props3._onStop,\n        passive = _props3.passive;\n\n    if (!passive) {\n      this._isActive = false;\n      (0, _framesync.cancelOnFrameUpdate)(this.scheduledUpdate);\n    }\n\n    if (this.onStop) this.onStop();\n    if (onStop) onStop(this);\n    if (_onStop) _onStop(this);\n    return this;\n  };\n\n  Action.prototype.complete = function complete() {\n    var _props4 = this.props,\n        onComplete = _props4.onComplete,\n        _onComplete = _props4._onComplete;\n    this.stop();\n    if (this.onComplete) this.onComplete();\n    if (onComplete) onComplete(this);\n    if (_onComplete) _onComplete(this);\n    return this;\n  };\n\n  Action.prototype.setProps = function setProps(_ref) {\n    var onUpdate = _ref.onUpdate,\n        props = _objectWithoutProperties(_ref, ['onUpdate']);\n\n    this.props = _extends({}, this.props, props);\n    if (onUpdate) this.output(onUpdate);\n    return this;\n  };\n\n  Action.prototype.output = function output(func) {\n    this.props.onUpdate = func;\n    if (func.registerAction) func.registerAction(this);\n    return this;\n  };\n\n  Action.prototype.get = function get() {\n    var transform = this.props.transform;\n    return transform ? transform(this.current) : this.current;\n  };\n\n  Action.prototype.getBeforeTransform = function getBeforeTransform() {\n    return this.current;\n  };\n\n  Action.prototype.set = function set(v) {\n    this.current = v;\n    return this;\n  };\n\n  Action.prototype.getProp = function getProp(key) {\n    return this.props[key];\n  };\n\n  Action.prototype.getVelocity = function getVelocity() {\n    return (0, _calc.speedPerSecond)(this.current - this.prev, this.lastUpdated);\n  };\n\n  Action.prototype.isActive = function isActive() {\n    return this._isActive;\n  };\n\n  Action.prototype.addListener = function addListener(listener) {\n    this.listeners = this.listeners || [];\n    this.numListeners = this.numListeners || 0;\n\n    if (this.listeners.indexOf(listener) === -1) {\n      this.listeners.push(listener);\n      this.numListeners++;\n    }\n\n    return this;\n  };\n\n  Action.prototype.removeListener = function removeListener(listener) {\n    var listenerIndex = this.listeners ? this.listeners.indexOf(listener) : -1;\n\n    if (listenerIndex !== -1) {\n      this.numListeners--;\n      this.listeners.splice(listenerIndex, 1);\n    }\n\n    return this;\n  };\n\n  Action.prototype.fireListeners = function fireListeners() {\n    var current = this.get();\n\n    for (var i = 0; i < this.numListeners; i++) {\n      this.listeners[i](current, this);\n    }\n\n    return this;\n  };\n\n  return Action;\n}();\n\nexports.default = Action;","map":null,"metadata":{},"sourceType":"script"}