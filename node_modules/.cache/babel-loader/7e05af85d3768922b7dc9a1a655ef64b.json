{"ast":null,"code":"'use strict';\n\nconst MongoNetworkError = require('./core').MongoNetworkError; // From spec@https://github.com/mongodb/specifications/blob/f93d78191f3db2898a59013a7ed5650352ef6da8/source/change-streams/change-streams.rst#resumable-error\n\n\nconst GET_MORE_RESUMABLE_CODES = new Set([6, // HostUnreachable\n7, // HostNotFound\n89, // NetworkTimeout\n91, // ShutdownInProgress\n189, // PrimarySteppedDown\n262, // ExceededTimeLimit\n9001, // SocketException\n10107, // NotMaster\n11600, // InterruptedAtShutdown\n11602, // InterruptedDueToReplStateChange\n13435, // NotMasterNoSlaveOk\n13436, // NotMasterOrSecondary\n63, // StaleShardVersion\n150, // StaleEpoch\n13388, // StaleConfig\n234, // RetryChangeStream\n133, // FailedToSatisfyReadPreference\n43 // CursorNotFound\n]);\n\nfunction isResumableError(error, wireVersion) {\n  if (error instanceof MongoNetworkError) {\n    return true;\n  }\n\n  if (wireVersion >= 9) {\n    // DRIVERS-1308: For 4.4 drivers running against 4.4 servers, drivers will add a special case to treat the CursorNotFound error code as resumable\n    if (error.code === 43) {\n      return true;\n    }\n\n    return error.hasErrorLabel('ResumableChangeStreamError');\n  }\n\n  return GET_MORE_RESUMABLE_CODES.has(error.code);\n}\n\nmodule.exports = {\n  GET_MORE_RESUMABLE_CODES,\n  isResumableError\n};","map":null,"metadata":{},"sourceType":"script"}