{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _value = require('./value');\n\nvar _value2 = _interopRequireDefault(_value);\n\nvar _composite = require('./composite');\n\nvar _composite2 = _interopRequireDefault(_composite);\n\nvar _parallel = require('./parallel');\n\nvar _parallel2 = _interopRequireDefault(_parallel);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction createTouches(initialTouches, _ref) {\n  var eventToTouches = _ref.eventToTouches,\n      moveEvent = _ref.moveEvent,\n      props = _objectWithoutProperties(_ref, ['eventToTouches', 'moveEvent']);\n\n  var touches = (0, _parallel2.default)(mapCoordsToActions(initialTouches), _extends({\n    preventDefault: true\n  }, props));\n\n  function updateTouches(e) {\n    if (props.preventDefault) e.preventDefault();\n    var latestTouches = eventToTouches(e);\n    updateActionWithTouches(touches, latestTouches);\n  }\n\n  touches.setProps({\n    _onStart: function _onStart() {\n      return document.documentElement.addEventListener(moveEvent, updateTouches);\n    },\n    _onStop: function _onStop() {\n      return document.documentElement.removeEventListener(moveEvent, updateTouches);\n    }\n  });\n  return touches;\n}\n\nfunction mapCoordsToActions(coords) {\n  var actions = [];\n\n  for (var i = 0; i < coords.length; i++) {\n    var _coords$i = coords[i],\n        x = _coords$i.x,\n        y = _coords$i.y;\n    actions[i] = (0, _composite2.default)({\n      x: (0, _value2.default)(x),\n      y: (0, _value2.default)(y)\n    });\n  }\n\n  return actions;\n}\n\nfunction updateActionWithTouches(touches, newTouches) {\n  for (var i = 0; i < newTouches.length; i++) {\n    var _newTouches$i = newTouches[i],\n        x = _newTouches$i.x,\n        y = _newTouches$i.y;\n    var touchActions = touches.getChildren();\n    var touchAction = touchActions[i];\n\n    if (touchAction !== undefined) {\n      touchAction.x.set(x);\n      touchAction.y.set(y);\n    } else {\n      touches.addAction((0, _composite2.default)({\n        x: (0, _value2.default)(x),\n        y: (0, _value2.default)(y)\n      }));\n    }\n  }\n}\n\nvar mouseEventToTouches = function mouseEventToTouches(_ref2) {\n  var pageX = _ref2.pageX,\n      pageY = _ref2.pageY;\n  return [{\n    x: pageX,\n    y: pageY\n  }];\n};\n\nvar touchEventToTouches = function touchEventToTouches(_ref3) {\n  var touches = _ref3.touches;\n  return extractCoords(touches);\n};\n\nfunction extractCoords(touches) {\n  var coords = [];\n\n  for (var i = 0; i < touches.length; i++) {\n    var _touches$i = touches[i],\n        clientX = _touches$i.clientX,\n        clientY = _touches$i.clientY;\n    coords[i] = {\n      x: clientX,\n      y: clientY\n    };\n  }\n\n  return coords;\n}\n\nvar getNativeEvent = function getNativeEvent(e) {\n  return e.originalEvent || e.nativeEvent || e;\n};\n\nexports.default = function (e, props) {\n  var nativeEvent = getNativeEvent(e);\n  return nativeEvent.touches ? createTouches(touchEventToTouches(e), _extends({\n    moveEvent: 'touchmove',\n    eventToTouches: touchEventToTouches\n  }, props)) : createTouches(mouseEventToTouches(e), _extends({\n    moveEvent: 'mousemove',\n    eventToTouches: mouseEventToTouches\n  }, props));\n};","map":{"version":3,"sources":["../../src/actions/touches.js"],"names":["eventToTouches","moveEvent","props","touches","mapCoordsToActions","preventDefault","e","latestTouches","updateActionWithTouches","_onStart","document","_onStop","actions","i","coords","x","y","newTouches","touchActions","touchAction","mouseEventToTouches","pageX","pageY","touchEventToTouches","extractCoords","clientX","clientY","getNativeEvent","nativeEvent"],"mappings":"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","sourcesContent":["import value from './value';\nimport composite from './composite';\nimport parallel from './parallel';\n\nfunction createTouches(initialTouches, { eventToTouches, moveEvent, ...props }) {\n  const touches = parallel(mapCoordsToActions(initialTouches), {\n    preventDefault: true,\n    ...props\n  });\n\n  function updateTouches(e) {\n    if (props.preventDefault) e.preventDefault();\n\n    const latestTouches = eventToTouches(e);\n    updateActionWithTouches(touches, latestTouches);\n  }\n\n  touches.setProps({\n    _onStart: () => document.documentElement.addEventListener(moveEvent, updateTouches),\n    _onStop: () => document.documentElement.removeEventListener(moveEvent, updateTouches)\n  });\n\n  return touches;\n}\n\nfunction mapCoordsToActions(coords) {\n  let actions = [];\n  for (let i = 0; i < coords.length; i++) {\n    const { x, y } = coords[i];\n    actions[i] = composite({\n      x: value(x),\n      y: value(y)\n    });\n  }\n  return actions;\n}\n\nfunction updateActionWithTouches(touches, newTouches) {\n  for (let i = 0; i < newTouches.length; i++) {\n    const { x, y } = newTouches[i];\n    const touchActions = touches.getChildren();\n    const touchAction = touchActions[i];\n    if (touchAction !== undefined) {\n      touchAction.x.set(x);\n      touchAction.y.set(y);\n    } else {\n      touches.addAction(composite({\n        x: value(x),\n        y: value(y)\n      }));\n    }\n  }\n}\n\nconst mouseEventToTouches = ({ pageX, pageY }) => [{ x: pageX, y: pageY }];\nconst touchEventToTouches = ({ touches }) => extractCoords(touches);\n\nfunction extractCoords(touches) {\n  let coords = [];\n  for (var i = 0; i < touches.length; i++) {\n    const { clientX, clientY } = touches[i];\n    coords[i] = {\n      x: clientX,\n      y: clientY\n    };\n  }\n  return coords;\n}\n\nconst getNativeEvent = (e) => e.originalEvent || e.nativeEvent || e;\n\nexport default (e, props) => {\n  const nativeEvent = getNativeEvent(e);\n  return (nativeEvent.touches) ?\n    createTouches(touchEventToTouches(e), {\n      moveEvent: 'touchmove',\n      eventToTouches: touchEventToTouches,\n      ...props\n    }) :\n    createTouches(mouseEventToTouches(e), {\n      moveEvent: 'mousemove',\n      eventToTouches: mouseEventToTouches,\n      ...props\n    });\n};\n"]},"metadata":{},"sourceType":"script"}