{"ast":null,"code":"'use strict';\n\nconst OperationBase = require('./operation').OperationBase;\n\nconst updateCallback = require('./common_functions').updateCallback;\n\nconst updateDocuments = require('./common_functions').updateDocuments;\n\nconst hasAtomicOperators = require('../utils').hasAtomicOperators;\n\nclass UpdateManyOperation extends OperationBase {\n  constructor(collection, filter, update, options) {\n    super(options);\n\n    if (!hasAtomicOperators(update)) {\n      throw new TypeError('Update document requires atomic operators');\n    }\n\n    this.collection = collection;\n    this.filter = filter;\n    this.update = update;\n  }\n\n  execute(callback) {\n    const coll = this.collection;\n    const filter = this.filter;\n    const update = this.update;\n    const options = this.options; // Set single document update\n\n    options.multi = true; // Execute update\n\n    updateDocuments(coll, filter, update, options, (err, r) => updateCallback(err, r, callback));\n  }\n\n}\n\nmodule.exports = UpdateManyOperation;","map":null,"metadata":{},"sourceType":"script"}